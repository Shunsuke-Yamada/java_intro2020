# 課題レポート3: リファクタリングを通してユニットテストとバージョン管理に慣れよう

- 前期からの変更点
  - 課題説明は「課題概要」のみで十分です。
  - 今回のレポート3についても「最大3ページ」に収めるようにして下さい。
    - ソースファイルも提出してもらうので、レポートに全コードコピペ掲載する必要はありません。特に工夫した点のみを掲載した上で解説・考察しよう。

- ＜目次＞
- <a href="#abst">課題概要</a>
- <a href="#details">詳細仕様</a>
  - <a href="#details_step0">ステップ0: コードの準備。</a>
  - <a href="#details_step1">ステップ1: 死亡した後で攻撃できてしまう件をどうにかしたい。</a>
  - <a href="#details_step2">ステップ2: カプセル化しよう。</a>
  - <a href="#details_step3">ステップ3: アクセサのJavaDocを書こう。</a>
- <a href="#report">取り組み方、レポートに含めるべき項目</a>
- <a href="#submit">提出方法</a>

<hr>

## <a name="abst">課題概要</a>
- コード例[ex-gradle](https://github.com/naltoma/ex-gradle)は、コードの書き方があまりヨロシクない。ユニットテストとバージョン管理システムを使いながら、一歩ずつリファクタリングしてみよう。

<hr>

## <a name="details">詳細仕様</a>
### <a name="details_step0">ステップ0: コードの準備。</a>
- IDEで新規プロジェクトを作成せよ。プロジェクト名は自由で良い（例えば ``~/prog2/report3`` ）。
- サンプルコードの準備。
  - [ex-gradle](https://github.com/naltoma/ex-gradle)を参考に、Hero.java, Enemy.java, Main.java, EnemyTest.java の4つを適切に配置せよ。App.java, AppTest.javaは不要である。pacakge名は各自アカウントに修正し、階層構造も適切に修正すること。
  - Main.javaの動作をIDE上で確認せよ。
  - ターミナル上でGradleのタスクrun, testが動作することを確認せよ。この時点でタスクtestは1件失敗して良い。あくまでもtestで確認したいのはJUnitによるテストコードが機能しているかどうかである。
- 動作確認後、GitHubリポジトリにpushせよ。
  - 自動生成されるファイルはaddしないこと。
- レポート報告事項
  - ステップ0に関しては、pushしたリポジトリURL（Git URL）を報告するだけで良い。

<hr>

### <a name="details_step1">ステップ1: 死亡した後で攻撃できてしまう件をどうにかしたい。</a>
- EnemyTestのattack()では、enemy.deadがtrueの時、すなわちenemyが死亡している時に攻撃できてしまうことを検証している。
  - Enemy.javaのattack()だけを修正し、「enemyが死亡時に攻撃できない」ようにせよ。他クラスやメソッドは変更しないこと。
    - ここで「攻撃できない」とは、相手のHPが減らないこととする。
  - 死亡時に攻撃できないようになれば、EnemyTest.attack()のテストは成功するはずである。テストが成功したら、commit & push せよ。
- レポート報告事項
  - Enemy.attack()の差分コードを以下の手順で掲載し、どのように修正したのか解説せよ。
    - 差分コードの出力手順
      - ターミナルでプロジェクトを保存しているディレクトリに移動する。（例の通りなら ~/prog2/report3/ 以下にあるはず）
      - ``git log -p -1`` を実行し、直近1つのコミットでの変更点を出力させる。この実行結果全体をレポートに含めよう。（このコマンドの意味は[前期資料](https://github.com/naltoma/python_intro/blob/master/Git.md)で確認しよう。）
  - 想定: 数行の追加で終わるはず。

<hr>

### <a name="details_step2">ステップ2: カプセル化しよう。</a>
- Hero, Enemyクラスのフィールド変数（String name, int hitPoint, int attack, boolean dead）は全てpublicになっている。勝手に他のクラスから修正されると困るため、これらをカプセル化しよう。
  - 上記4変数を private にしよう。
  - フィールド変数を参照・設定するためのアクセサ（getter/setter method）も用意しよう。
  - この隠蔽化に伴い、直接フィールド変数へアクセスしている箇所でエラーが起きるはずだ。エラーが起きた箇所を、アクセサを利用することで修正しよう。
  - MainクラスとEnemyTestクラスが正常動作することを確認できたら、commit & push しよう。
- レポート報告事項
  - コード掲載は不要である。今回の修正を通して気づいた点を報告せよ。

<hr>

### <a name="details_step3">ステップ3: アクセサのJavaDocを書こう。</a>
- 授業で示したJavaDoc例を元に、ステップ2で追加したメソッドのドキュメントをJavaDoc形式で書こう。
  - 記述したらHTMLドキュメントを生成し、想定通りに反映されていることを確認すること。
  - 確認できたらJavaのソースファイルだけをpushしよう。ドキュメントは自動生成できるので含めなくて良い。
- レポート報告事項
  - HeroもしくはEnemyどちらかのHTMLドキュメントをブラウザで参照した際の画面キャプチャを含めよ。

<hr>

## <a name="report">取り組み方、レポートに含めるべき項目</a>
- ペアや友人らと話し合って取り組んで構わないが、コード解説を加えるなど「自分自身の報告書」となるように取り組むこと。試して分かったこと、自身で解決できなかった部分等についてどう取り組んだか、といった過程がわかるように示すこと。（考えを図表や文章を駆使して表現して報告する練習です）
- レポート作成は好きなツール（ソフトウェア）を使って構わない。ただし下記を含めること。
  - タイトル
    - 今回は「**プログラミング2、レポート課題3: 「リファクタリングを通してユニットテストとバージョン管理に慣れよう」**」。
  - 提出日: yyyy-mm-dd
  - 報告者: 学籍番号、氏名
    - 複数人で相談しながらやった場合、相談者らを「**協力者: 学籍番号、氏名**」として示そう。
  - 課題説明（概要のみでOK）
  - **Step 0について**
    - pushしたリポジトリURL（Git URL）を報告すること。
  - **Step 1について**
    - 指定手順で得られる EnemyTest.attack()の差分コードを掲載し、どのように修正したのか解説せよ。
  - **Step 2について**
    - 今回のコード修正を通して、気づいたことを報告せよ。
  - **Step 3について**
    - キャプチャ画像を掲載せよ。
  - その他
    - 通常は感想等をレポートには含めませんが、練習なので課題に取り組みながら何か感じたこと、悩んでいること等、書きたいことがあれば自由に書いてください。（なければ省略OK）

<hr>

## <a name="submit">提出方法</a>
- 提出物は「レポート」の1点である。
  - ソースファイルの提出は不要。（GitHubで確認します）
- レポートは電子ファイルで提出するものとする。
- 提出先:
  - Google ドキュメントのreport3。
- 締切: 調整中。
